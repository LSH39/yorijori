<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="recipe">
 	<select id="selectRecipeList" resultType="rb">
 		select 
 			recipe_no as recipeNo, 
 			recipe_title as recipeTitle, 
 			filepath,
 			read_count as readCount,
 			recipe_time as recipeTime, 
 			recipe_level as recipeLevel,
		(select member_nickname from Member m  where m.member_no = r.recipe_writer) as nickname 
		from recipe_board r
 	</select>
 	<insert id="insertRecipeBoard" parameterType="rb" >
 		insert into recipe_board values(recipe_seq.nextval,#{recipeWriter},#{recipeTitle},#{filepath},0,to_char(sysdate,'yyyy-mm-dd'),#{subhead},#{recipeVideo},#{recipeTime},#{foodName},#{recipeLevel},#{situation},#{material})
 	</insert>
 	<select id="selectRecipeNo" resultType="_int">
 		select max(recipe_no) from recipe_board 
 	</select>
 	<insert id="insertMaterial" parameterType="material">
 		insert into material values(material_seq.nextval,#{recipeNo},#{materialName},#{mAmount})
 	</insert>
 	<insert id="insertContent" parameterType="rcontent">
 		insert into recipe_content values(r_file_seq.nextval,#{recipeNo},#{filename},#{filepath},#{recipeContent})
 	</insert>
 	<select id="selectCategory1" parameterType="string" resultType="rb">
 	   select 
 			recipe_no as recipeNo, 
 			recipe_title as recipeTitle, 
 			filepath,
 			read_count as readCount,
 			recipe_time as recipeTime, 
 			recipe_level as recipeLevel,
        (select member_nickname from member m where m.member_no=r.recipe_writer)as nickname
 	from recipe_board r where situation=#{item}
 	</select>
 	<select id="selectCategory2" parameterType="string" resultType="rb">
 		select 
 			recipe_no as recipeNo, 
 			recipe_title as recipeTitle, 
 			filepath,
 			read_count as readCount,
 			recipe_time as recipeTime, 
 			recipe_level as recipeLevel,
        	(select member_nickname from member m where m.member_no=r.recipe_writer)as nickname
 		from recipe_board r where material=#{item2}
 	</select>
 	<select id="selectCategory3" parameterType="string" resultType="rb">
 		select 
 			recipe_no as recipeNo, 
 			recipe_title as recipeTitle, 
 			filepath,
 			read_count as readCount,
 			recipe_time as recipeTime, 
 			recipe_level as recipeLevel,
        	(select member_nickname from member m where m.member_no=r.recipe_writer)as nickname
 		from recipe_board r where recipe_level=#{item3}
 	</select>
 	<select id="selectOneRecipe" parameterType="_int" resultType="rb">
 		select
 			recipe_no as recipeNo,
 			recipe_title as recipeTitle, 
 			filepath,
 			read_count as readCount,
 			recipe_date recipeDate,
 			subhead,
 			recipe_video as recipeVide,
 			recipe_time as recipeTime,
 			food_name as foodName,
 			recipe_time as recipeTime, 
 			recipe_level as recipeLevel,
 			(select member_nickname from member m where m.member_no=r.recipe_writer)as nickname
 		from recipe_board r where recipe_no=#{recipeNo}
 			
 	</select>
 	<select id="selectMaterial"  parameterType="_int" resultType="material">
 		select 
 			material_no as materialNo,
 			recipe_no as recipeNo,
 			material_name as materialName,
 			m_amount as mAmount
 		from material where recipe_no=#{recipeNo}
 	</select>
 	<select id="selectContent" parameterType="_int" resultType="rcontent">
 		select 
 			r_file_no as rFileNo,
 			recipe_no as recipeNo,
 			filename, filepath,
 			recipe_content as recipeContent
 		from recipe_content where recipe_no=#{recipeNo}
 	</select>
 	<select id="selectComment" parameterType="_int" resultType="rcomment">
 		select 
 			r_comment_no as rCommentNo,
 			recipe_no as recipeNo,
 			rc_content as rcContent,
 			rc_date as rcDate,
        (select member_nickname from member m where m.member_no = rc.member_no)as nickname 
 		from recipe_comment rc where recipe_no=#{recipeNo}
 	</select>
 	<insert id="insertComment" parameterType="rcomment">
 		insert into recipe_comment values(rc_seq.nextval,#{recipeNo},#{memberNo},#{rcContent},to_char(sysdate,'yyyy-mm-dd'))
 		
 	</insert>
</mapper>
